---
import { Icon } from 'astro-icon/components';
---

<header class='mb-12 flex w-full flex-wrap pb-3 text-sm sm:flex-nowrap sm:justify-start'>
  <nav class='relative mx-auto flex w-full items-center justify-between sm:flex sm:items-center'>
    <a class='flex-none text-xl font-semibold' href='/' aria-label='Mikael Brevik'>mib</a>

    <div class='flex flex-row items-center justify-center gap-x-5 sm:gap-x-7'>
      <a href='/blog' class='flex-none text-[1.05rem] font-medium hover:text-foreground/75'
        >Posts
      </a>
      <a href='/tools' class='flex-none text-[1.05rem] font-medium hover:text-foreground/75'
        >Tools & Equipment
      </a>

      <button
        id='toggleDarkMode'
        class='relative rounded-md border border-border p-1.5 transition-all hover:bg-border'
      >
        <span class='sr-only'>Dark Theme</span>
        <Icon
          name='ph:sun'
          title='Light Theme'
          class='hidden h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:block dark:rotate-0 dark:scale-100'
        />

        <Icon
          name='ph:moon-fill'
          title='Dark Theme'
          class='h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:hidden dark:-rotate-90 dark:scale-0'
        />
      </button>
    </div>
  </nav>
</header>

<script>
  function getCurrentTheme() {
    return localStorage.getItem('theme');
  }
  const toggleDarkModeButton = document.getElementById('toggleDarkMode');

  toggleDarkModeButton?.addEventListener('click', () => {
    const toggleDarkModeEvent = new CustomEvent('theme-change', {
      detail: { theme: getCurrentTheme() === 'light' ? 'dark' : 'light' },
    });
    document.dispatchEvent(toggleDarkModeEvent);
  });
</script>
